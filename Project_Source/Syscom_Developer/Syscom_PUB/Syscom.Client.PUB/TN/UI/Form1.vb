Imports System.IO

Public Class Form1
    Private Sub Button1_Click_1(sender As Object, e As EventArgs) Handles Button1.Click
        Dim pub As New PUBRuleBP

        Dim Result As Boolean = False
        Dim TriggerItemSetXML As String = ""
        Dim OperationDSXML As String = ""
        Dim TriggerItemSet As New DataSet
        Dim OperationDS As New DataSet


        TriggerItemSetXML = RichTextBox1.Text.Replace(RichTextBox1.Text.Chars(16).ToString(), "")
        ' TriggerItemSetXML = "<TriggerItemSet>  <Trigger_Item>    <ItemCode>A00004</ItemCode>    <ItemParam />    <ValueData />    <IsCodeExchanged>Y</IsCodeExchanged>  </Trigger_Item>  <Trigger_Item>    <ItemCode>D00012</ItemCode>    <ItemParam />    <ValueData>044555</ValueData>    <IsCodeExchanged>Y</IsCodeExchanged>  </Trigger_Item>  <Trigger_Item>    <ItemCode>D00013</ItemCode>    <ItemParam />    <ValueData>01</ValueData>    <IsCodeExchanged>Y</IsCodeExchanged>  </Trigger_Item>  <Trigger_Item>    <ItemCode>D00005</ItemCode>    <ItemParam />    <ValueData />    <IsCodeExchanged>Y</IsCodeExchanged>  </Trigger_Item></TriggerItemSet>"
        OperationDSXML = RichTextBox2.Text.Replace(RichTextBox2.Text.Chars(13).ToString(), "")
        ' OperationDSXML = "<OperationDS>  <Medical_Record>    <Source_Type>O</Source_Type>    <Medical_Sn>O20100820000018</Medical_Sn>    <Chart_No>02964164</Chart_No>    <Order_Date>2010-08-20 00:00:00</Order_Date>    <Visit_End_Date>2010-08-20 00:00:00</Visit_End_Date>    <Dept_Code>01</Dept_Code>    <Medical_Type_Id />    <Card_Sn />    <Doctor_Code>044555</Doctor_Code>    <Main_Identity_Id>1</Main_Identity_Id>    <Sub_Identity_Code>01</Sub_Identity_Code>    <Case_Type_Id />    <Part_Code />  </Medical_Record>  <Diagnosis>    <Icd_Code>4280</Icd_Code>    <Icd_Sort_Value>1</Icd_Sort_Value>    <Diagnosis_Type_Id>1</Diagnosis_Type_Id>  </Diagnosis>  <Order_Record>    <Order_Code>148356</Order_Code>    <Order_Date>2010-08-20 14:32:17</Order_Date>    <Body_Site_Code />    <Body_Side_Code />    <Dosage>1.0000</Dosage>    <Dosage_Unit>btl</Dosage_Unit>    <Frequency_Code>AS ORDER</Frequency_Code>    <Days>7</Days>    <Tqty>1.00</Tqty>    <Tqty_Unit>BTL</Tqty_Unit>    <Is_Chronic_Card>N</Is_Chronic_Card>    <Is_Cure>N</Is_Cure>    <Specimen_Id />    <Order_Effect_Date>2010-08-20 14:32:17</Order_Effect_Date>    <Order_End_Date>2010-08-27 14:32:17</Order_End_Date>    <Cure_Type_Id />    <Order_Doctor_Code>044555</Order_Doctor_Code>    <Usage_Code>EN</Usage_Code>    <Is_Force>N</Is_Force>    <Class_Code>5450</Class_Code>    <Order_Name />    <Consumption_Dept>PH50</Consumption_Dept>    <Order_Sno>01</Order_Sno>  </Order_Record>  <Patient>    <Age_Year>84</Age_Year>    <Age_Month>11</Age_Month>    <Age_Day>13</Age_Day>    <Birth_Date>19250907000000</Birth_Date>    <Sex_Id>2</Sex_Id>    <Blood_Type_Id>A+</Blood_Type_Id>    <Disability>N</Disability>    <Age_By_Month>1019</Age_By_Month>  </Patient></OperationDS>"

        '===================================================
        ' 2010/08/10
        '===================================================

        'TriggerItemSetXML = "<TriggerItemSet>   <Trigger_Item>     <ItemCode>A00004</ItemCode>     <ItemParam />     <ValueData />     <IsCodeExchanged>Y</IsCodeExchanged>   </Trigger_Item>   <Trigger_Item>     <ItemCode>D00012</ItemCode>     <ItemParam />     <ValueData>026066</ValueData>     <IsCodeExchanged>Y</IsCodeExchanged>   </Trigger_Item>   <Trigger_Item>     <ItemCode>D00013</ItemCode>     <ItemParam />     <ValueData>01</ValueData>     <IsCodeExchanged>Y</IsCodeExchanged>   </Trigger_Item>   <Trigger_Item>     <ItemCode>D00005</ItemCode>     <ItemParam />     <ValueData />     <IsCodeExchanged>Y</IsCodeExchanged>   </Trigger_Item> </TriggerItemSet> "
        'OperationDSXML = "<OperationDS>   <Medical_Record>     <Source_Type>O</Source_Type>     <Medical_Sn>O20100810000009</Medical_Sn>     <Chart_No>04862565</Chart_No>     <Order_Date>2010-08-10 00:00:00</Order_Date>     <Visit_End_Date>2010-08-10 00:00:00</Visit_End_Date>     <Dept_Code>01</Dept_Code>     <Medical_Type_Id />     <Card_Sn />     <Doctor_Code>026066</Doctor_Code>     <Main_Identity_Id>1</Main_Identity_Id>     <Sub_Identity_Code>01</Sub_Identity_Code>     <Case_Type_Id />     <Part_Code />   </Medical_Record>   <Order_Record>     <Order_Code>082828</Order_Code>     <Order_Date>2010-08-10 13:49:39</Order_Date>     <Body_Site_Code />     <Body_Side_Code />     <Dosage>345.0000</Dosage>     <Dosage_Unit>tab</Dosage_Unit>     <Frequency_Code>QD</Frequency_Code>     <Days>7</Days>     <Tqty>2415.00</Tqty>     <Tqty_Unit>TAB</Tqty_Unit>     <Is_Chronic_Card>N</Is_Chronic_Card>     <Is_Cure>N</Is_Cure>     <Specimen_Id />     <Order_Effect_Date>2010-08-10 13:49:37</Order_Effect_Date>     <Order_End_Date>2010-08-17 13:49:37</Order_End_Date>     <Cure_Type_Id />     <Order_Doctor_Code>026066</Order_Doctor_Code>     <Usage_Code>PC</Usage_Code>     <Is_Force>N</Is_Force>     <Class_Code>7553</Class_Code>     <Order_Name />     <Consumption_Dept>PH50</Consumption_Dept>   </Order_Record>   <Patient>     <Age_Year>65</Age_Year>     <Age_Month>4</Age_Month>     <Age_Day>21</Age_Day>     <Birth_Date>19450320000000</Birth_Date>     <Sex_Id>2</Sex_Id>     <Blood_Type_Id />     <Disability>N</Disability>     <Age_By_Month>784</Age_By_Month>   </Patient> </OperationDS> "

        '===================================================
        ' Test Case.03 -- asorder case
        '===================================================

        'TriggerItemSetXML = "<TriggerItemSet>   <Trigger_Item>     <ItemCode>A00004</ItemCode>     <ItemParam />     <ValueData />     <IsCodeExchanged>Y</IsCodeExchanged>   </Trigger_Item>   <Trigger_Item>     <ItemCode>D00012</ItemCode>     <ItemParam />     <ValueData>040880</ValueData>     <IsCodeExchanged>Y</IsCodeExchanged>   </Trigger_Item>   <Trigger_Item>     <ItemCode>D00013</ItemCode>     <ItemParam />     <ValueData>42</ValueData>     <IsCodeExchanged>Y</IsCodeExchanged>   </Trigger_Item>   <Trigger_Item>     <ItemCode>D00005</ItemCode>     <ItemParam />     <ValueData />     <IsCodeExchanged>Y</IsCodeExchanged>   </Trigger_Item> </TriggerItemSet> "
        'OperationDSXML = "<OperationDS>   <Medical_Record>     <Source_Type>O</Source_Type>     <Medical_Sn>O20100723000231</Medical_Sn>     <Chart_No>02873214</Chart_No>     <Order_Date>2010-07-23 00:00:00</Order_Date>     <Visit_End_Date>2010-07-23 00:00:00</Visit_End_Date>     <Dept_Code>42</Dept_Code>     <Medical_Type_Id />     <Card_Sn />     <Doctor_Code>040880</Doctor_Code>     <Main_Identity_Id>1</Main_Identity_Id>     <Sub_Identity_Code>01</Sub_Identity_Code>     <Case_Type_Id />     <Part_Code />   </Medical_Record>   <Diagnosis>     <Icd_Code>1110</Icd_Code>     <Icd_Sort_Value>1</Icd_Sort_Value>     <Diagnosis_Type_Id>1</Diagnosis_Type_Id>   </Diagnosis>   <Order_Record>     <Order_Code>283540</Order_Code>     <Order_Date>2010-07-23 18:22:03</Order_Date>     <Body_Site_Code />     <Body_Side_Code />     <Dosage>1.0000</Dosage>     <Dosage_Unit>q.s.</Dosage_Unit>     <Frequency_Code>AS ORDER</Frequency_Code>     <Days>7</Days>     <Tqty>1.00</Tqty>     <Tqty_Unit>TUBE</Tqty_Unit>     <Is_Chronic_Card>N</Is_Chronic_Card>     <Is_Cure>N</Is_Cure>     <Specimen_Id />     <Order_Effect_Date>2010-07-23 18:22:04</Order_Effect_Date>     <Order_End_Date>2010-07-30 18:22:04</Order_End_Date>     <Cure_Type_Id />     <Order_Doctor_Code>040880</Order_Doctor_Code>     <Usage_Code>EXT</Usage_Code>     <Is_Force>N</Is_Force>     <Class_Code>4510</Class_Code>     <Order_Name />     <Consumption_Dept>PH50</Consumption_Dept>   </Order_Record>   <Patient>     <Age_Year>47</Age_Year>     <Age_Month>8</Age_Month>     <Age_Day>16</Age_Day>     <Birth_Date>19621107000000</Birth_Date>     <Sex_Id>1</Sex_Id>     <Blood_Type_Id />     <Disability>N</Disability>   </Patient> </OperationDS> "

        '===================================================
        ' TestCase02-20100723
        '===================================================

        'TriggerItemSetXML = "<TriggerItemSet>   <Trigger_Item>     <ItemCode>A00004</ItemCode>     <ItemParam />     <ValueData />     <IsCodeExchanged>Y</IsCodeExchanged>   </Trigger_Item>   <Trigger_Item>     <ItemCode>D00012</ItemCode>     <ItemParam />     <ValueData>026066</ValueData>     <IsCodeExchanged>Y</IsCodeExchanged>   </Trigger_Item>   <Trigger_Item>     <ItemCode>D00013</ItemCode>     <ItemParam />     <ValueData>21</ValueData>     <IsCodeExchanged>Y</IsCodeExchanged>   </Trigger_Item>   <Trigger_Item>     <ItemCode>D00005</ItemCode>     <ItemParam />     <ValueData />     <IsCodeExchanged>Y</IsCodeExchanged>   </Trigger_Item> </TriggerItemSet> "
        'OperationDSXML = "<OperationDS>   <Medical_Record>     <Source_Type>O</Source_Type>     <Medical_Sn>O20100723000078</Medical_Sn>     <Chart_No>05853555</Chart_No>     <Order_Date>2010-07-23 00:00:00</Order_Date>     <Visit_End_Date>2010-07-23 00:00:00</Visit_End_Date>     <Dept_Code>21</Dept_Code>     <Medical_Type_Id />     <Card_Sn />     <Doctor_Code>026066</Doctor_Code>     <Main_Identity_Id>1</Main_Identity_Id>     <Sub_Identity_Code>01</Sub_Identity_Code>     <Case_Type_Id />     <Part_Code />   </Medical_Record>   <Order_Record>     <Order_Code>525620</Order_Code>     <Order_Date>2010-07-23 12:41:46</Order_Date>     <Body_Site_Code />     <Body_Side_Code />     <Dosage>1.0000</Dosage>     <Dosage_Unit>tab</Dosage_Unit>     <Frequency_Code>QD</Frequency_Code>     <Days>7</Days>     <Tqty>7.00</Tqty>     <Tqty_Unit>TAB</Tqty_Unit>     <Is_Chronic_Card>N</Is_Chronic_Card>     <Is_Cure>N</Is_Cure>     <Specimen_Id />     <Order_Effect_Date>2010-07-23 12:41:46</Order_Effect_Date>     <Order_End_Date>2010-07-30 12:41:46</Order_End_Date>     <Cure_Type_Id />     <Order_Doctor_Code>026066</Order_Doctor_Code>     <Usage_Code>PC</Usage_Code>     <Is_Force>Y</Is_Force>     <Class_Code>3340</Class_Code>     <Order_Name />   </Order_Record>   <Order_Record>     <Order_Code>362128</Order_Code>     <Order_Date>2010-07-23 12:41:46</Order_Date>     <Body_Site_Code />     <Body_Side_Code />     <Dosage>1.0000</Dosage>     <Dosage_Unit>cap</Dosage_Unit>     <Frequency_Code>QD</Frequency_Code>     <Days>7</Days>     <Tqty>7.00</Tqty>     <Tqty_Unit>CAP</Tqty_Unit>     <Is_Chronic_Card>N</Is_Chronic_Card>     <Is_Cure>N</Is_Cure>     <Specimen_Id />     <Order_Effect_Date>2010-07-23 12:41:46</Order_Effect_Date>     <Order_End_Date>2010-07-30 12:41:46</Order_End_Date>     <Cure_Type_Id />     <Order_Doctor_Code>026066</Order_Doctor_Code>     <Usage_Code>PC</Usage_Code>     <Is_Force>N</Is_Force>     <Class_Code>6672</Class_Code>     <Order_Name />   </Order_Record>   <Order_Record>     <Order_Code>362136</Order_Code>     <Order_Date>2010-07-23 12:41:46</Order_Date>     <Body_Site_Code />     <Body_Side_Code />     <Dosage>1.0000</Dosage>     <Dosage_Unit>mL</Dosage_Unit>     <Frequency_Code>TID</Frequency_Code>     <Days>7</Days>     <Tqty>1.00</Tqty>     <Tqty_Unit>BTL</Tqty_Unit>     <Is_Chronic_Card>N</Is_Chronic_Card>     <Is_Cure>N</Is_Cure>     <Specimen_Id />     <Order_Effect_Date>2010-07-23 12:41:46</Order_Effect_Date>     <Order_End_Date>2010-07-30 12:41:46</Order_End_Date>     <Cure_Type_Id />     <Order_Doctor_Code>026066</Order_Doctor_Code>     <Usage_Code>PC</Usage_Code>     <Is_Force>N</Is_Force>     <Class_Code>7812</Class_Code>     <Order_Name />   </Order_Record>   <Order_Record>     <Order_Code>363834</Order_Code>     <Order_Date>2010-07-23 12:41:46</Order_Date>     <Body_Site_Code />     <Body_Side_Code />     <Dosage>1.0000</Dosage>     <Dosage_Unit>gtt</Dosage_Unit>     <Frequency_Code>QD</Frequency_Code>     <Days>7</Days>     <Tqty>1.00</Tqty>     <Tqty_Unit>BTL</Tqty_Unit>     <Is_Chronic_Card>N</Is_Chronic_Card>     <Is_Cure>N</Is_Cure>     <Specimen_Id />     <Order_Effect_Date>2010-07-23 12:41:46</Order_Effect_Date>     <Order_End_Date>2010-07-30 12:41:46</Order_End_Date>     <Cure_Type_Id />     <Order_Doctor_Code>026066</Order_Doctor_Code>     <Usage_Code>PC</Usage_Code>     <Is_Force>N</Is_Force>     <Class_Code>5710</Class_Code>     <Order_Name />   </Order_Record>   <Order_Record>     <Order_Code>364823</Order_Code>     <Order_Date>2010-07-23 12:41:46</Order_Date>     <Body_Site_Code />     <Body_Side_Code />     <Dosage>1.0000</Dosage>     <Dosage_Unit>cap</Dosage_Unit>     <Frequency_Code>QD</Frequency_Code>     <Days>7</Days>     <Tqty>7.00</Tqty>     <Tqty_Unit>CAP</Tqty_Unit>     <Is_Chronic_Card>N</Is_Chronic_Card>     <Is_Cure>N</Is_Cure>     <Specimen_Id />     <Order_Effect_Date>2010-07-23 12:41:46</Order_Effect_Date>     <Order_End_Date>2010-07-30 12:41:46</Order_End_Date>     <Cure_Type_Id />     <Order_Doctor_Code>026066</Order_Doctor_Code>     <Usage_Code>PC</Usage_Code>     <Is_Force>N</Is_Force>     <Class_Code>5710</Class_Code>     <Order_Name />   </Order_Record>   <Patient>     <Age_Year>36</Age_Year>     <Age_Month>8</Age_Month>     <Age_Day>22</Age_Day>     <Birth_Date>19731101000000</Birth_Date>     <Sex_Id>1</Sex_Id>     <Blood_Type_Id>O+</Blood_Type_Id>     <Disability>N</Disability>   </Patient> </OperationDS> "

        '===================================================
        ' TestCase01-20100723
        '===================================================

        'TriggerItemSetXML = "<TriggerItemSet>   <Trigger_Item>     <ItemCode>A00004</ItemCode>     <ItemParam />     <ValueData>035554</ValueData>     <IsCodeExchanged>Y</IsCodeExchanged>   </Trigger_Item>   <Trigger_Item>     <ItemCode>D00005</ItemCode>     <ItemParam />     <ValueData />     <IsCodeExchanged>Y</IsCodeExchanged>   </Trigger_Item>   <Trigger_Item>     <ItemCode>D00012</ItemCode>     <ItemParam />     <ValueData>037156</ValueData>     <IsCodeExchanged>Y</IsCodeExchanged>   </Trigger_Item>   <Trigger_Item>     <ItemCode>D00013</ItemCode>     <ItemParam />     <ValueData>71</ValueData>     <IsCodeExchanged>Y</IsCodeExchanged>   </Trigger_Item> </TriggerItemSet> "
        'OperationDSXML = "<OperationDS>   <Medical_Record>     <Source_Type>O</Source_Type>     <Medical_Sn>O20100723000080</Medical_Sn>     <Chart_No>09671498</Chart_No>     <Order_Date>2010-07-23 00:00:00</Order_Date>     <Visit_End_Date>2010-07-23 00:00:00</Visit_End_Date>     <Dept_Code>71</Dept_Code>     <Medical_Type_Id />     <Card_Sn />     <Doctor_Code>037156</Doctor_Code>     <Main_Identity_Id>2</Main_Identity_Id>     <Sub_Identity_Code>30</Sub_Identity_Code>     <Case_Type_Id />     <Part_Code />   </Medical_Record>   <Diagnosis>     <Icd_Code>36423</Icd_Code>     <Icd_Sort_Value>1</Icd_Sort_Value>     <Diagnosis_Type_Id>1</Diagnosis_Type_Id>   </Diagnosis>   <Order_Record>     <Order_Code>035554</Order_Code>     <Order_Date>2010-07-23 12:42:44</Order_Date>     <Body_Site_Code />     <Body_Side_Code />     <Dosage>1.0000</Dosage>     <Dosage_Unit>syrg</Dosage_Unit>     <Frequency_Code>Q2W</Frequency_Code>     <Days>7</Days>     <Tqty>1.00</Tqty>     <Tqty_Unit>SYRG</Tqty_Unit>     <Is_Chronic_Card>N</Is_Chronic_Card>     <Is_Cure>N</Is_Cure>     <Specimen_Id />     <Order_Effect_Date>2010-07-23</Order_Effect_Date>     <Order_End_Date>2010-07-30</Order_End_Date>     <Cure_Type_Id />     <Order_Doctor_Code>037156</Order_Doctor_Code>     <Usage_Code>SC</Usage_Code>     <Is_Force>N</Is_Force>     <Class_Code>6340</Class_Code>     <Order_Name />   </Order_Record>   <Patient>     <Age_Year>61</Age_Year>     <Age_Month>2</Age_Month>     <Age_Day>19</Age_Day>     <Birth_Date>19490504000000</Birth_Date>     <Sex_Id>1</Sex_Id>     <Blood_Type_Id>O+</Blood_Type_Id>     <Disability>N</Disability>   </Patient> </OperationDS> "

        '===================================================
        ' TestCase05
        '===================================================

        'TriggerItemSetXML = "<TriggerItemSet>  <Trigger_Item>    <ItemCode>A00004</ItemCode>    <ItemParam />    <ValueData />    <IsCodeExchanged>Y</IsCodeExchanged>  </Trigger_Item>  <Trigger_Item>    <ItemCode>A00021</ItemCode>    <ItemParam />    <ValueData>12584750</ValueData>    <IsCodeExchanged>Y</IsCodeExchanged>  </Trigger_Item>  <Trigger_Item>    <ItemCode>A00022</ItemCode>    <ItemParam />    <ValueData />    <IsCodeExchanged>Y</IsCodeExchanged>  </Trigger_Item>  <Trigger_Item>    <ItemCode>D00012</ItemCode>    <ItemParam />    <ValueData>023996</ValueData>    <IsCodeExchanged>Y</IsCodeExchanged>  </Trigger_Item>  <Trigger_Item>    <ItemCode>D00013</ItemCode>    <ItemParam />    <ValueData>42</ValueData>    <IsCodeExchanged>Y</IsCodeExchanged>  </Trigger_Item>  <Trigger_Item>    <ItemCode>D00004</ItemCode>    <ItemParam />    <ValueData>42</ValueData>    <IsCodeExchanged>Y</IsCodeExchanged>  </Trigger_Item>  <Trigger_Item>    <ItemCode>D00005</ItemCode>    <ItemParam />    <ValueData />    <IsCodeExchanged>Y</IsCodeExchanged>  </Trigger_Item>  <Trigger_Item>    <ItemCode>K00001</ItemCode>    <ItemParam />    <ValueData />    <IsCodeExchanged>Y</IsCodeExchanged>  </Trigger_Item>  <Trigger_Item>    <ItemCode>K00007</ItemCode>    <ItemParam />    <ValueData />    <IsCodeExchanged>Y</IsCodeExchanged>  </Trigger_Item></TriggerItemSet>"
        'OperationDSXML = "<OperationDS>  <Medical_Record>    <Source_Type>O</Source_Type>    <Medical_Sn>O20100717000024</Medical_Sn>    <Chart_No>12584750</Chart_No>    <Order_Date>2010-07-17 00:00:00</Order_Date>    <Visit_End_Date>2010-07-17 00:00:00</Visit_End_Date>    <Dept_Code>42</Dept_Code>    <Medical_Type_Id />    <Card_Sn />    <Doctor_Code>023996</Doctor_Code>    <Main_Identity_Id>2</Main_Identity_Id>    <Sub_Identity_Code>30</Sub_Identity_Code>    <Case_Type_Id />    <Part_Code />  </Medical_Record>  <Diagnosis>    <Icd_Code>4019</Icd_Code>    <Icd_Sort_Value>1</Icd_Sort_Value>    <Diagnosis_Type_Id>1</Diagnosis_Type_Id>  </Diagnosis>  <Diagnosis>    <Icd_Code>25080</Icd_Code>    <Icd_Sort_Value>2</Icd_Sort_Value>    <Diagnosis_Type_Id>1</Diagnosis_Type_Id>  </Diagnosis>  <Diagnosis>    <Icd_Code>3006</Icd_Code>    <Icd_Sort_Value>3</Icd_Sort_Value>    <Diagnosis_Type_Id>1</Diagnosis_Type_Id>  </Diagnosis>  <Order_Record>    <Order_Code>002008</Order_Code>    <Order_Date>2010-07-17 14:19:03</Order_Date>    <Body_Site_Code />    <Body_Side_Code />    <Dosage>0</Dosage>    <Frequency_Code />    <Days>1</Days>    <Tqty>1</Tqty>    <Tqty_Unit>次</Tqty_Unit>    <Is_Chronic_Card>N</Is_Chronic_Card>    <Is_Cure>N</Is_Cure>    <Order_Effect_Date>2010-07-17 00:00:00</Order_Effect_Date>    <Order_End_Date>2010-07-17 00:00:00</Order_End_Date>    <Cure_Type_Id />    <Order_Doctor_Code>023996</Order_Doctor_Code>    <Is_Force>N</Is_Force>    <Order_Name />  </Order_Record>  <Order_Record>    <Order_Code>4200302</Order_Code>    <Order_Date>2010-07-17 14:19:03</Order_Date>    <Body_Site_Code />    <Body_Side_Code />    <Dosage>0</Dosage>    <Days>1</Days>    <Tqty>1</Tqty>    <Tqty_Unit />    <Is_Chronic_Card>N</Is_Chronic_Card>    <Is_Cure>N</Is_Cure>    <Specimen_Id>04</Specimen_Id>    <Order_Effect_Date>2010-07-17 00:00:00</Order_Effect_Date>    <Order_End_Date>2010-07-17 00:00:00</Order_End_Date>    <Order_Doctor_Code>023996</Order_Doctor_Code>    <Is_Force>N</Is_Force>    <Order_Name />  </Order_Record><Order_Record>    <Order_Code>8211009</Order_Code>    <Order_Date>2010-07-17 14:19:03</Order_Date>    <Body_Site_Code />    <Body_Side_Code />    <Dosage>0</Dosage>    <Days>1</Days>    <Tqty>1</Tqty>    <Tqty_Unit />    <Is_Chronic_Card>N</Is_Chronic_Card>    <Is_Cure>N</Is_Cure>    <Specimen_Id>10</Specimen_Id>    <Order_Effect_Date>2010-07-17 00:00:00</Order_Effect_Date>    <Order_End_Date>2010-07-17 00:00:00</Order_End_Date>    <Order_Doctor_Code>023996</Order_Doctor_Code>    <Is_Force>N</Is_Force>    <Order_Name />  </Order_Record>  <Order_Record>    <Order_Code>8211012</Order_Code>    <Order_Date>2010-07-17 14:19:03</Order_Date>    <Body_Site_Code />    <Body_Side_Code />    <Dosage>0</Dosage>    <Days>1</Days>    <Tqty>1</Tqty>    <Tqty_Unit />    <Is_Chronic_Card>N</Is_Chronic_Card>    <Is_Cure>N</Is_Cure>    <Specimen_Id>10</Specimen_Id>    <Order_Effect_Date>2010-07-17 00:00:00</Order_Effect_Date>    <Order_End_Date>2010-07-17 00:00:00</Order_End_Date>    <Order_Doctor_Code>023996</Order_Doctor_Code>    <Is_Force>N</Is_Force>    <Order_Name />  </Order_Record>  <Order_Record>    <Order_Code>8211013</Order_Code>    <Order_Date>2010-07-17 14:19:03</Order_Date>    <Body_Site_Code />    <Body_Side_Code />    <Dosage>0</Dosage>    <Days>1</Days>    <Tqty>1</Tqty>    <Tqty_Unit />    <Is_Chronic_Card>N</Is_Chronic_Card>    <Is_Cure>N</Is_Cure>    <Specimen_Id>10</Specimen_Id>    <Order_Effect_Date>2010-07-17 00:00:00</Order_Effect_Date>    <Order_End_Date>2010-07-17 00:00:00</Order_End_Date>    <Order_Doctor_Code>023996</Order_Doctor_Code>    <Is_Force>N</Is_Force>    <Order_Name />  </Order_Record><Order_Record>    <Order_Code>8211019</Order_Code>    <Order_Date>2010-07-17 14:19:03</Order_Date>    <Body_Site_Code />    <Body_Side_Code />    <Dosage>0</Dosage>    <Days>1</Days>    <Tqty>1</Tqty>    <Tqty_Unit />    <Is_Chronic_Card>N</Is_Chronic_Card>    <Is_Cure>N</Is_Cure>    <Specimen_Id>10</Specimen_Id>    <Order_Effect_Date>2010-07-17 00:00:00</Order_Effect_Date>    <Order_End_Date>2010-07-17 00:00:00</Order_End_Date>    <Order_Doctor_Code>023996</Order_Doctor_Code>    <Is_Force>N</Is_Force>    <Order_Name />  </Order_Record>  <Order_Record>    <Order_Code>8211036</Order_Code>    <Order_Date>2010-07-17 14:19:03</Order_Date>    <Body_Site_Code />    <Body_Side_Code />    <Dosage>0</Dosage>    <Days>1</Days>    <Tqty>1</Tqty>    <Tqty_Unit />    <Is_Chronic_Card>N</Is_Chronic_Card>    <Is_Cure>N</Is_Cure>    <Specimen_Id>10</Specimen_Id>    <Order_Effect_Date>2010-07-17 00:00:00</Order_Effect_Date>    <Order_End_Date>2010-07-17 00:00:00</Order_End_Date>    <Order_Doctor_Code>023996</Order_Doctor_Code>    <Is_Force>N</Is_Force>    <Order_Name />  </Order_Record>  <Order_Record>    <Order_Code>8221003</Order_Code>    <Order_Date>2010-07-17 14:19:03</Order_Date>    <Body_Site_Code />    <Body_Side_Code />    <Dosage>0</Dosage>    <Days>1</Days>    <Tqty>1</Tqty>    <Tqty_Unit />    <Is_Chronic_Card>N</Is_Chronic_Card>    <Is_Cure>N</Is_Cure>    <Specimen_Id>10</Specimen_Id>    <Order_Effect_Date>2010-07-17 00:00:00</Order_Effect_Date>    <Order_End_Date>2010-07-17 00:00:00</Order_End_Date>    <Order_Doctor_Code>023996</Order_Doctor_Code>    <Is_Force>N</Is_Force>    <Order_Name />  </Order_Record>  <Order_Record><Order_Code>8221004</Order_Code>    <Order_Date>2010-07-17 14:19:03</Order_Date>    <Body_Site_Code />    <Body_Side_Code />    <Dosage>0</Dosage>    <Days>1</Days>    <Tqty>1</Tqty>    <Tqty_Unit />    <Is_Chronic_Card>N</Is_Chronic_Card>    <Is_Cure>N</Is_Cure>    <Specimen_Id>10</Specimen_Id>    <Order_Effect_Date>2010-07-17 00:00:00</Order_Effect_Date>    <Order_End_Date>2010-07-17 00:00:00</Order_End_Date>    <Order_Doctor_Code>023996</Order_Doctor_Code>    <Is_Force>N</Is_Force>    <Order_Name />  </Order_Record>  <Order_Record>    <Order_Code>9110101</Order_Code>    <Order_Date>2010-07-17 14:19:03</Order_Date>    <Body_Site_Code>91X10</Body_Site_Code>    <Body_Side_Code />    <Dosage>0</Dosage>    <Days>1</Days>    <Tqty>1</Tqty>    <Tqty_Unit />    <Is_Chronic_Card>N</Is_Chronic_Card>    <Is_Cure>N</Is_Cure>    <Specimen_Id />    <Order_Effect_Date>2010-07-17 00:00:00</Order_Effect_Date>    <Order_End_Date>2010-07-17 00:00:00</Order_End_Date>    <Order_Doctor_Code>023996</Order_Doctor_Code>    <Is_Force>N</Is_Force>    <Order_Name />  </Order_Record><Order_Record>    <Order_Code>066923</Order_Code>    <Order_Date>2010-07-17 14:19:03</Order_Date>    <Body_Site_Code />    <Body_Side_Code />    <Dosage>2</Dosage>    <Dosage_Unit>tab</Dosage_Unit>    <Frequency_Code>QD</Frequency_Code>    <Days>7</Days>    <Tqty>14.00</Tqty>    <Tqty_Unit>TAB</Tqty_Unit>    <Is_Chronic_Card>N</Is_Chronic_Card>    <Is_Cure>N</Is_Cure>    <Order_Effect_Date>2010-07-17 00:00:00</Order_Effect_Date>    <Order_End_Date>2010-07-23 00:00:00</Order_End_Date>    <Order_Doctor_Code>023996</Order_Doctor_Code>    <Is_Force>N</Is_Force>    <Order_Name />  </Order_Record>  <Order_Record>    <Order_Code>283421</Order_Code>    <Order_Date>2010-07-17 14:19:03</Order_Date>    <Body_Site_Code />    <Body_Side_Code />    <Dosage>2</Dosage>    <Dosage_Unit>mg</Dosage_Unit>    <Frequency_Code>HS</Frequency_Code>    <Days>7</Days>    <Tqty>4.00</Tqty>    <Tqty_Unit>TAB</Tqty_Unit>    <Is_Chronic_Card>N</Is_Chronic_Card>    <Is_Cure>N</Is_Cure>    <Order_Effect_Date>2010-07-17 00:00:00</Order_Effect_Date>    <Order_End_Date>2010-07-23 00:00:00</Order_End_Date>    <Order_Doctor_Code>023996</Order_Doctor_Code>    <Is_Force>N</Is_Force>    <Order_Name />  </Order_Record>  <Order_Record>    <Order_Code>589028</Order_Code>    <Order_Date>2010-07-17 14:19:03</Order_Date>    <Body_Site_Code />    <Body_Side_Code />    <Dosage>2</Dosage>    <Dosage_Unit>mg</Dosage_Unit>    <Frequency_Code>TID</Frequency_Code>    <Days>7</Days>    <Tqty>9.00</Tqty>    <Tqty_Unit>TAB</Tqty_Unit>    <Is_Chronic_Card>N</Is_Chronic_Card>    <Is_Cure>N</Is_Cure>    <Order_Effect_Date>2010-07-17 00:00:00</Order_Effect_Date>    <Order_End_Date>2010-07-23 00:00:00</Order_End_Date>    <Order_Doctor_Code>023996</Order_Doctor_Code>    <Is_Force>N</Is_Force>    <Order_Name />  </Order_Record><Order_Record>    <Order_Code>965353</Order_Code>    <Order_Date>2010-07-17 14:19:03</Order_Date>    <Body_Site_Code />    <Body_Side_Code />    <Dosage>1</Dosage>    <Dosage_Unit />    <Frequency_Code />    <Days>1</Days>    <Tqty>1</Tqty>    <Tqty_Unit />    <Is_Chronic_Card>N</Is_Chronic_Card>    <Is_Cure>N</Is_Cure>    <Order_Effect_Date>2010-07-17 00:00:00</Order_Effect_Date>    <Order_End_Date>2010-07-18 14:19:04</Order_End_Date>    <Order_Doctor_Code>023996</Order_Doctor_Code>    <Is_Force>N</Is_Force>    <Order_Name />  </Order_Record>  <Order_Record>    <Order_Code>8211007</Order_Code>    <Order_Date>2010-07-17 14:19:03</Order_Date>    <Body_Site_Code />    <Body_Side_Code />    <Dosage>0</Dosage>    <Days>1</Days>    <Tqty>1</Tqty>    <Tqty_Unit />    <Is_Chronic_Card>N</Is_Chronic_Card>    <Is_Cure>N</Is_Cure>    <Specimen_Id>10</Specimen_Id>    <Order_Effect_Date>2010-07-17 00:00:00</Order_Effect_Date>    <Order_End_Date>2010-07-17 00:00:00</Order_End_Date>    <Order_Doctor_Code>023996</Order_Doctor_Code>    <Is_Force>N</Is_Force>    <Order_Name />  </Order_Record>  <Order_Record>    <Order_Code>8211008</Order_Code>    <Order_Date>2010-07-17 14:19:03</Order_Date>    <Body_Site_Code />    <Body_Side_Code />    <Dosage>0</Dosage>    <Days>1</Days>    <Tqty>1</Tqty>    <Tqty_Unit />    <Is_Chronic_Card>N</Is_Chronic_Card>    <Is_Cure>N</Is_Cure>    <Specimen_Id>10</Specimen_Id>    <Order_Effect_Date>2010-07-17 00:00:00</Order_Effect_Date>    <Order_End_Date>2010-07-17 00:00:00</Order_End_Date>    <Order_Doctor_Code>023996</Order_Doctor_Code>    <Is_Force>N</Is_Force>    <Order_Name />  </Order_Record><Order_Record>    <Order_Code>8231072</Order_Code>    <Order_Date>2010-07-17 14:19:03</Order_Date>    <Body_Site_Code />    <Body_Side_Code />    <Dosage>0</Dosage>    <Days>1</Days>    <Tqty>1</Tqty>    <Tqty_Unit />    <Is_Chronic_Card>N</Is_Chronic_Card>    <Is_Cure>N</Is_Cure>    <Specimen_Id>10</Specimen_Id>    <Order_Effect_Date>2010-07-17 00:00:00</Order_Effect_Date>    <Order_End_Date>2010-07-17 00:00:00</Order_End_Date>    <Order_Doctor_Code>023996</Order_Doctor_Code>    <Is_Force>N</Is_Force>    <Order_Name />  </Order_Record>  <Order_Record>    <Order_Code>008002</Order_Code>    <Order_Date>2010-07-17 14:19:03</Order_Date>    <Body_Site_Code />    <Body_Side_Code />    <Dosage>0</Dosage>    <Days>1</Days>    <Tqty>1</Tqty>    <Tqty_Unit>次</Tqty_Unit>    <Is_Chronic_Card>N</Is_Chronic_Card>    <Is_Cure>N</Is_Cure>    <Order_Effect_Date>2010-07-17 14:18:21</Order_Effect_Date>    <Order_End_Date>2010-07-17 14:18:21</Order_End_Date>    <Order_Doctor_Code>023996</Order_Doctor_Code>    <Is_Force>N</Is_Force>    <Order_Name />  </Order_Record>  <Patient>    <Age_Year>66</Age_Year>    <Age_Month>11</Age_Month>    <Age_Day>8</Age_Day>    <Birth_Date>19440809000000</Birth_Date>    <Sex_Id>2</Sex_Id>    <Blood_Type_Id />    <Disability>N</Disability>  </Patient></OperationDS>"

        '===================================================
        ' TestCase04
        '===================================================

        'TriggerItemSetXML = "<TriggerItemSet>  <Trigger_Item>    <ItemCode>A00004</ItemCode>    <ItemParam />    <ValueData />    <IsCodeExchanged>Y</IsCodeExchanged>  </Trigger_Item>  <Trigger_Item>    <ItemCode>D00012</ItemCode>    <ItemParam />    <ValueData>019982</ValueData>    <IsCodeExchanged>Y</IsCodeExchanged>  </Trigger_Item>  <Trigger_Item>    <ItemCode>D00013</ItemCode>    <ItemParam />    <ValueData>61</ValueData>    <IsCodeExchanged>Y</IsCodeExchanged>  </Trigger_Item>  <Trigger_Item>    <ItemCode>D00005</ItemCode>    <ItemParam />    <ValueData />    <IsCodeExchanged>Y</IsCodeExchanged>  </Trigger_Item></TriggerItemSet>"
        'OperationDSXML = "<OperationDS>  <Medical_Record>    <Source_Type>O</Source_Type>    <Medical_Sn>O20100717000134</Medical_Sn>    <Chart_No>09894609</Chart_No>    <Order_Date>2010-07-17 00:00:00</Order_Date>    <Visit_End_Date>2010-07-17 00:00:00</Visit_End_Date>    <Dept_Code>61</Dept_Code>    <Medical_Type_Id />    <Card_Sn />    <Doctor_Code>019982</Doctor_Code>    <Main_Identity_Id>1</Main_Identity_Id>    <Sub_Identity_Code>01</Sub_Identity_Code>    <Case_Type_Id />    <Part_Code />  </Medical_Record>  <Diagnosis>    <Icd_Code>485</Icd_Code>    <Icd_Sort_Value>1</Icd_Sort_Value>    <Diagnosis_Type_Id>1</Diagnosis_Type_Id>  </Diagnosis>  <Order_Record>    <Order_Code>6057021</Order_Code>    <Order_Date>2010-07-17 14:36:25</Order_Date>    <Body_Site_Code />    <Body_Side_Code />    <Dosage>0</Dosage>    <Dosage_Unit />    <Frequency_Code />    <Days>1</Days>    <Tqty>1</Tqty>    <Tqty_Unit />    <Is_Chronic_Card>N</Is_Chronic_Card>    <Is_Cure>N</Is_Cure>    <Specimen_Id />    <Order_Effect_Date>2010-07-17 14:36:25</Order_Effect_Date>    <Order_End_Date>2010-07-18 14:36:25</Order_End_Date>    <Cure_Type_Id />    <Order_Doctor_Code>019982</Order_Doctor_Code>    <Is_Force>N</Is_Force>    <Class_Code />    <Order_Name />  </Order_Record>  <Patient>    <Age_Year>10</Age_Year>    <Age_Month>4</Age_Month>    <Age_Day>15</Age_Day>    <Birth_Date>20000302000000</Birth_Date>    <Sex_Id>2</Sex_Id>    <Blood_Type_Id />    <Disability>N</Disability>  </Patient></OperationDS>"

        '===================================================
        ' TestCase03
        '===================================================

        'TriggerItemSetXML = "<TriggerItemSet>  <Trigger_Item>    <ItemCode>A00004</ItemCode>    <ItemParam />    <ValueData />    <IsCodeExchanged>Y</IsCodeExchanged>  </Trigger_Item>  <Trigger_Item>    <ItemCode>D00012</ItemCode>    <ItemParam />    <ValueData>619201</ValueData>    <IsCodeExchanged>Y</IsCodeExchanged>  </Trigger_Item>  <Trigger_Item>    <ItemCode>D00013</ItemCode>    <ItemParam />    <ValueData>35</ValueData>    <IsCodeExchanged>Y</IsCodeExchanged>  </Trigger_Item>  <Trigger_Item>    <ItemCode>D00005</ItemCode>    <ItemParam />    <ValueData />    <IsCodeExchanged>Y</IsCodeExchanged>  </Trigger_Item></TriggerItemSet>"
        'OperationDSXML = "<OperationDS>  <Medical_Record>    <Source_Type>O</Source_Type>    <Medical_Sn>O20100715000109</Medical_Sn>    <Chart_No>13758137</Chart_No>    <Order_Date>2010-07-15 00:00:00</Order_Date>    <Visit_End_Date>2010-07-15 00:00:00</Visit_End_Date>    <Dept_Code>35</Dept_Code>    <Medical_Type_Id />    <Card_Sn />    <Doctor_Code>619201</Doctor_Code>    <Main_Identity_Id>2</Main_Identity_Id>    <Sub_Identity_Code>30</Sub_Identity_Code>    <Case_Type_Id />    <Part_Code />  </Medical_Record>  <Diagnosis>    <Icd_Code>22800</Icd_Code>    <Icd_Sort_Value>1</Icd_Sort_Value>    <Diagnosis_Type_Id>1</Diagnosis_Type_Id>  </Diagnosis>  <Diagnosis>    <Icd_Code>1470</Icd_Code>    <Icd_Sort_Value>2</Icd_Sort_Value>    <Diagnosis_Type_Id>1</Diagnosis_Type_Id>  </Diagnosis>  <Order_Record>    <Order_Code>037039</Order_Code>    <Order_Date>2010-07-15 17:22:47</Order_Date>    <Body_Site_Code />    <Body_Side_Code />    <Dosage>0</Dosage>    <Dosage_Unit />    <Frequency_Code />    <Days>1</Days>    <Tqty>1</Tqty>    <Tqty_Unit>次</Tqty_Unit>    <Is_Chronic_Card>N</Is_Chronic_Card>    <Is_Cure>N</Is_Cure>    <Specimen_Id />    <Order_Effect_Date>2010-07-15 17:22:47</Order_Effect_Date>    <Order_End_Date>2010-07-16 17:22:47</Order_End_Date>    <Cure_Type_Id />    <Order_Doctor_Code>619201</Order_Doctor_Code>    <Is_Force>N</Is_Force>    <Class_Code />    <Order_Name />  </Order_Record><Order_Record>    <Order_Code>039004</Order_Code>    <Order_Date>2010-07-15 17:22:47</Order_Date>    <Body_Site_Code />    <Body_Side_Code />    <Dosage>0</Dosage>    <Dosage_Unit />    <Frequency_Code />    <Days>1</Days>    <Tqty>1</Tqty>    <Tqty_Unit>次</Tqty_Unit>    <Is_Chronic_Card>N</Is_Chronic_Card>    <Is_Cure>N</Is_Cure>    <Specimen_Id />    <Order_Effect_Date>2010-07-15 17:22:47</Order_Effect_Date>    <Order_End_Date>2010-07-16 17:22:47</Order_End_Date>    <Cure_Type_Id />    <Order_Doctor_Code>619201</Order_Doctor_Code>    <Is_Force>N</Is_Force>    <Class_Code />    <Order_Name />  </Order_Record>  <Patient>    <Age_Year>0</Age_Year>    <Age_Month>7</Age_Month>    <Age_Day>25</Age_Day>    <Birth_Date>20091120000000</Birth_Date>    <Sex_Id>1</Sex_Id>    <Height>165.5</Height>    <Weight>81.4</Weight>    <Blood_Type_Id />    <Disability>N</Disability>  </Patient></OperationDS>"

        '===================================================
        ' TestCase02
        '===================================================

        'TriggerItemSetXML = "<TriggerItemSet>  <Trigger_Item>    <ItemCode>A00004</ItemCode>    <ItemParam />    <ValueData />    <IsCodeExchanged>Y</IsCodeExchanged>  </Trigger_Item>  <Trigger_Item>    <ItemCode>A00021</ItemCode>    <ItemParam />    <ValueData>03319275</ValueData>    <IsCodeExchanged>Y</IsCodeExchanged>  </Trigger_Item>  <Trigger_Item>    <ItemCode>A00022</ItemCode>    <ItemParam />    <ValueData />    <IsCodeExchanged>Y</IsCodeExchanged>  </Trigger_Item>  <Trigger_Item>    <ItemCode>D00012</ItemCode>    <ItemParam />    <ValueData>602066</ValueData>    <IsCodeExchanged>Y</IsCodeExchanged>  </Trigger_Item>  <Trigger_Item>    <ItemCode>D00013</ItemCode>    <ItemParam />    <ValueData>31</ValueData>    <IsCodeExchanged>Y</IsCodeExchanged>  </Trigger_Item>  <Trigger_Item>    <ItemCode>D00004</ItemCode>    <ItemParam />    <ValueData>31</ValueData>    <IsCodeExchanged>Y</IsCodeExchanged>  </Trigger_Item>  <Trigger_Item>    <ItemCode>D00005</ItemCode>    <ItemParam />    <ValueData />    <IsCodeExchanged>Y</IsCodeExchanged>  </Trigger_Item>  <Trigger_Item>    <ItemCode>K00001</ItemCode>    <ItemParam />    <ValueData />    <IsCodeExchanged>Y</IsCodeExchanged>  </Trigger_Item>  <Trigger_Item>    <ItemCode>K00007</ItemCode>    <ItemParam />    <ValueData />    <IsCodeExchanged>Y</IsCodeExchanged>  </Trigger_Item></TriggerItemSet>"
        'OperationDSXML = "<OperationDS>  <Medical_Record>    <Source_Type>O</Source_Type>    <Medical_Sn>O20100715000086</Medical_Sn>    <Chart_No>03319275</Chart_No>    <Order_Date>2010-07-15 00:00:00</Order_Date>    <Visit_End_Date>2010-07-15 00:00:00</Visit_End_Date>    <Dept_Code>31</Dept_Code>    <Medical_Type_Id />    <Card_Sn />    <Doctor_Code>602066</Doctor_Code>    <Main_Identity_Id>2</Main_Identity_Id>    <Sub_Identity_Code>30</Sub_Identity_Code>    <Case_Type_Id />    <Part_Code />  </Medical_Record>  <Diagnosis>    <Icd_Code>7100</Icd_Code>    <Icd_Sort_Value>1</Icd_Sort_Value>    <Diagnosis_Type_Id>1</Diagnosis_Type_Id>  </Diagnosis>  <Diagnosis>    <Icd_Code>2724</Icd_Code>    <Icd_Sort_Value>2</Icd_Sort_Value>    <Diagnosis_Type_Id>1</Diagnosis_Type_Id>  </Diagnosis>  <Diagnosis>    <Icd_Code>53190</Icd_Code>    <Icd_Sort_Value>3</Icd_Sort_Value>    <Diagnosis_Type_Id>1</Diagnosis_Type_Id>  </Diagnosis>  <Diagnosis>    <Icd_Code>7140</Icd_Code>    <Icd_Sort_Value>4</Icd_Sort_Value>    <Diagnosis_Type_Id>1</Diagnosis_Type_Id>  </Diagnosis>  <Order_Record>    <Order_Code>089023</Order_Code>    <Order_Date>2010-07-15 17:30:02</Order_Date>    <Body_Site_Code />    <Body_Side_Code />    <Dosage>2.00</Dosage>    <Dosage_Unit>tab</Dosage_Unit>    <Frequency_Code>QD</Frequency_Code>    <Days>28.00</Days>    <Tqty>56.00</Tqty>    <Tqty_Unit>TAB</Tqty_Unit>    <Is_Chronic_Card>N</Is_Chronic_Card>    <Is_Cure>N</Is_Cure>    <Order_Effect_Date>2010-07-15 00:00:00</Order_Effect_Date>    <Order_End_Date>2010-08-11 00:00:00</Order_End_Date>    <Order_Doctor_Code>602066</Order_Doctor_Code>    <Is_Force>N</Is_Force>    <Class_Code>6340</Class_Code>    <Order_Name />  </Order_Record><Order_Record>    <Order_Code>664521</Order_Code>    <Order_Date>2010-07-15 17:30:02</Order_Date>    <Body_Site_Code />    <Body_Side_Code />    <Dosage>2.00</Dosage>    <Dosage_Unit>tab</Dosage_Unit>    <Frequency_Code>QD</Frequency_Code>    <Days>28.00</Days>    <Tqty>56.00</Tqty>    <Tqty_Unit>TAB</Tqty_Unit>    <Is_Chronic_Card>N</Is_Chronic_Card>    <Is_Cure>N</Is_Cure>    <Order_Effect_Date>2010-07-15 00:00:00</Order_Effect_Date>    <Order_End_Date>2010-08-11 00:00:00</Order_End_Date>    <Order_Doctor_Code>602066</Order_Doctor_Code>    <Is_Force>N</Is_Force>    <Class_Code>5410</Class_Code>    <Order_Name />  </Order_Record>  <Order_Record>    <Order_Code>605041</Order_Code>    <Order_Date>2010-07-15 17:30:02</Order_Date>    <Body_Site_Code />    <Body_Side_Code />    <Dosage>1.00</Dosage>    <Dosage_Unit>q.s.</Dosage_Unit>    <Frequency_Code>PRN</Frequency_Code>    <Days>28.00</Days>    <Tqty>1.00</Tqty>    <Tqty_Unit>TUBE</Tqty_Unit>    <Is_Chronic_Card>N</Is_Chronic_Card>    <Is_Cure>N</Is_Cure>    <Order_Effect_Date>2010-07-15 00:00:00</Order_Effect_Date>    <Order_End_Date>2010-08-11 00:00:00</Order_End_Date>    <Order_Doctor_Code>602066</Order_Doctor_Code>    <Is_Force>N</Is_Force>    <Class_Code>4570</Class_Code>    <Order_Name />  </Order_Record>  <Order_Record>    <Order_Code>8211008</Order_Code>    <Order_Date>2010-07-15 17:30:02</Order_Date>    <Body_Site_Code />    <Body_Side_Code />    <Dosage>0</Dosage>    <Days>1</Days>    <Tqty>1.00</Tqty>    <Tqty_Unit />    <Is_Chronic_Card>N</Is_Chronic_Card>    <Is_Cure>N</Is_Cure>    <Specimen_Id>10</Specimen_Id>    <Order_Effect_Date>2010-07-15 00:00:00</Order_Effect_Date>    <Order_End_Date>2010-07-15 00:00:00</Order_End_Date>    <Order_Doctor_Code>602066</Order_Doctor_Code>    <Is_Force>N</Is_Force>    <Order_Name />  </Order_Record><Order_Record>    <Order_Code>8211009</Order_Code>    <Order_Date>2010-07-15 17:30:02</Order_Date>    <Body_Site_Code />    <Body_Side_Code />    <Dosage>0</Dosage>    <Days>1</Days>    <Tqty>1.00</Tqty>    <Tqty_Unit />    <Is_Chronic_Card>N</Is_Chronic_Card>    <Is_Cure>N</Is_Cure>    <Specimen_Id>10</Specimen_Id>    <Order_Effect_Date>2010-07-15 00:00:00</Order_Effect_Date>    <Order_End_Date>2010-07-15 00:00:00</Order_End_Date>    <Order_Doctor_Code>602066</Order_Doctor_Code>    <Is_Force>N</Is_Force>    <Order_Name />  </Order_Record>  <Order_Record>    <Order_Code>8211018</Order_Code>    <Order_Date>2010-07-15 17:30:02</Order_Date>    <Body_Site_Code />    <Body_Side_Code />    <Dosage>0</Dosage>    <Days>1</Days>    <Tqty>1.00</Tqty>    <Tqty_Unit />    <Is_Chronic_Card>N</Is_Chronic_Card>    <Is_Cure>N</Is_Cure>    <Specimen_Id>10</Specimen_Id>    <Order_Effect_Date>2010-07-15 00:00:00</Order_Effect_Date>    <Order_End_Date>2010-07-15 00:00:00</Order_End_Date>    <Order_Doctor_Code>602066</Order_Doctor_Code>    <Is_Force>N</Is_Force>    <Order_Name />  </Order_Record>  <Order_Record>    <Order_Code>8211019</Order_Code>    <Order_Date>2010-07-15 17:30:02</Order_Date>    <Body_Site_Code />    <Body_Side_Code />    <Dosage>0</Dosage>    <Days>1</Days>    <Tqty>1.00</Tqty>    <Tqty_Unit />    <Is_Chronic_Card>N</Is_Chronic_Card>    <Is_Cure>N</Is_Cure>    <Specimen_Id>10</Specimen_Id>    <Order_Effect_Date>2010-07-15 00:00:00</Order_Effect_Date>    <Order_End_Date>2010-07-15 00:00:00</Order_End_Date>    <Order_Doctor_Code>602066</Order_Doctor_Code>    <Is_Force>N</Is_Force>    <Order_Name />  </Order_Record><Order_Record>    <Order_Code>8211110</Order_Code>    <Order_Date>2010-07-15 17:30:02</Order_Date>    <Body_Site_Code />    <Body_Side_Code />    <Dosage>0</Dosage>    <Days>1</Days>    <Tqty>1.00</Tqty>    <Tqty_Unit />    <Is_Chronic_Card>N</Is_Chronic_Card>    <Is_Cure>N</Is_Cure>    <Specimen_Id>10</Specimen_Id>    <Order_Effect_Date>2010-07-15 00:00:00</Order_Effect_Date>    <Order_End_Date>2010-07-15 00:00:00</Order_End_Date>    <Order_Doctor_Code>602066</Order_Doctor_Code>    <Is_Force>N</Is_Force>    <Order_Name />  </Order_Record>  <Order_Record>    <Order_Code>8213096</Order_Code>    <Order_Date>2010-07-15 17:30:02</Order_Date>    <Body_Site_Code />    <Body_Side_Code />    <Dosage>0</Dosage>    <Days>1</Days>    <Tqty>1.00</Tqty>    <Tqty_Unit />    <Is_Chronic_Card>N</Is_Chronic_Card>    <Is_Cure>N</Is_Cure>    <Specimen_Id>04</Specimen_Id>    <Order_Effect_Date>2010-07-15 00:00:00</Order_Effect_Date>    <Order_End_Date>2010-07-15 00:00:00</Order_End_Date>    <Order_Doctor_Code>602066</Order_Doctor_Code>    <Is_Force>N</Is_Force>    <Order_Name />  </Order_Record><Order_Record>    <Order_Code>8213088</Order_Code>    <Order_Date>2010-07-15 17:30:02</Order_Date>    <Body_Site_Code />    <Body_Side_Code />    <Dosage>0</Dosage>    <Days>1</Days>    <Tqty>1.00</Tqty>    <Tqty_Unit />    <Is_Chronic_Card>N</Is_Chronic_Card>    <Is_Cure>N</Is_Cure>    <Specimen_Id>04</Specimen_Id>    <Order_Effect_Date>2010-07-15 00:00:00</Order_Effect_Date>    <Order_End_Date>2010-07-15 00:00:00</Order_End_Date>    <Order_Doctor_Code>602066</Order_Doctor_Code>    <Is_Force>N</Is_Force>    <Order_Name />  </Order_Record>  <Order_Record>    <Order_Code>8216004</Order_Code>    <Order_Date>2010-07-15 17:30:02</Order_Date>    <Body_Site_Code />    <Body_Side_Code />    <Dosage>0</Dosage>    <Days>1</Days>    <Tqty>1.00</Tqty>    <Tqty_Unit />    <Is_Chronic_Card>N</Is_Chronic_Card>    <Is_Cure>N</Is_Cure>    <Specimen_Id>10</Specimen_Id>    <Order_Effect_Date>2010-07-15 00:00:00</Order_Effect_Date>    <Order_End_Date>2010-07-15 00:00:00</Order_End_Date>    <Order_Doctor_Code>602066</Order_Doctor_Code>    <Is_Force>N</Is_Force>    <Order_Name />  </Order_Record><Order_Record>    <Order_Code>8216005</Order_Code>    <Order_Date>2010-07-15 17:30:02</Order_Date>    <Body_Site_Code />    <Body_Side_Code />    <Dosage>0</Dosage>    <Days>1</Days>    <Tqty>1.00</Tqty>    <Tqty_Unit />    <Is_Chronic_Card>N</Is_Chronic_Card>    <Is_Cure>N</Is_Cure>    <Specimen_Id>10</Specimen_Id>    <Order_Effect_Date>2010-07-15 00:00:00</Order_Effect_Date>    <Order_End_Date>2010-07-15 00:00:00</Order_End_Date>    <Order_Doctor_Code>602066</Order_Doctor_Code>    <Is_Force>N</Is_Force>    <Order_Name />  </Order_Record>  <Order_Record>    <Order_Code>8216031</Order_Code>    <Order_Date>2010-07-15 17:30:02</Order_Date>    <Body_Site_Code />    <Body_Side_Code />    <Dosage>0</Dosage>    <Days>1</Days>    <Tqty>1.00</Tqty>    <Tqty_Unit />    <Is_Chronic_Card>N</Is_Chronic_Card>    <Is_Cure>N</Is_Cure>    <Specimen_Id>10</Specimen_Id>    <Order_Effect_Date>2010-07-15 00:00:00</Order_Effect_Date>    <Order_End_Date>2010-07-15 00:00:00</Order_End_Date>    <Order_Doctor_Code>602066</Order_Doctor_Code>    <Is_Force>N</Is_Force>    <Order_Name />  </Order_Record>  <Order_Record>    <Order_Code>8216033</Order_Code>    <Order_Date>2010-07-15 17:30:02</Order_Date>    <Body_Site_Code />    <Body_Side_Code />    <Dosage>0</Dosage>    <Days>1</Days>    <Tqty>1.00</Tqty>    <Tqty_Unit />    <Is_Chronic_Card>N</Is_Chronic_Card>    <Is_Cure>N</Is_Cure>    <Specimen_Id>10</Specimen_Id>    <Order_Effect_Date>2010-07-15 00:00:00</Order_Effect_Date>    <Order_End_Date>2010-07-15 00:00:00</Order_End_Date>    <Order_Doctor_Code>602066</Order_Doctor_Code>    <Is_Force>N</Is_Force>    <Order_Name />  </Order_Record><Order_Record>    <Order_Code>8216034</Order_Code>    <Order_Date>2010-07-15 17:30:02</Order_Date>    <Body_Site_Code />    <Body_Side_Code />    <Dosage>0</Dosage>    <Days>1</Days>    <Tqty>1.00</Tqty>    <Tqty_Unit />    <Is_Chronic_Card>N</Is_Chronic_Card>    <Is_Cure>N</Is_Cure>    <Specimen_Id>10</Specimen_Id>    <Order_Effect_Date>2010-07-15 00:00:00</Order_Effect_Date>    <Order_End_Date>2010-07-15 00:00:00</Order_End_Date>    <Order_Doctor_Code>602066</Order_Doctor_Code>    <Is_Force>N</Is_Force>    <Order_Name />  </Order_Record>  <Order_Record>    <Order_Code>8221002</Order_Code>    <Order_Date>2010-07-15 17:30:02</Order_Date>    <Body_Site_Code />    <Body_Side_Code />    <Dosage>0</Dosage>    <Days>1</Days>    <Tqty>1.00</Tqty>    <Tqty_Unit />    <Is_Chronic_Card>N</Is_Chronic_Card>    <Is_Cure>N</Is_Cure>    <Specimen_Id>10</Specimen_Id>    <Order_Effect_Date>2010-07-15 00:00:00</Order_Effect_Date>    <Order_End_Date>2010-07-15 00:00:00</Order_End_Date>    <Order_Doctor_Code>602066</Order_Doctor_Code>    <Is_Force>N</Is_Force>    <Order_Name />  </Order_Record>  <Order_Record>    <Order_Code>8221009</Order_Code>    <Order_Date>2010-07-15 17:30:02</Order_Date>    <Body_Site_Code />    <Body_Side_Code />    <Dosage>0</Dosage>    <Days>1</Days>    <Tqty>1.00</Tqty>    <Tqty_Unit />    <Is_Chronic_Card>N</Is_Chronic_Card>    <Is_Cure>N</Is_Cure>    <Specimen_Id>10</Specimen_Id>    <Order_Effect_Date>2010-07-15 00:00:00</Order_Effect_Date>    <Order_End_Date>2010-07-15 00:00:00</Order_End_Date>    <Order_Doctor_Code>602066</Order_Doctor_Code>    <Is_Force>N</Is_Force>    <Order_Name />  </Order_Record><Order_Record>    <Order_Code>8222057</Order_Code>    <Order_Date>2010-07-15 17:30:02</Order_Date>    <Body_Site_Code />    <Body_Side_Code />    <Dosage>0</Dosage>    <Days>1</Days>    <Tqty>1.00</Tqty>    <Tqty_Unit />    <Is_Chronic_Card>N</Is_Chronic_Card>    <Is_Cure>N</Is_Cure>    <Specimen_Id>10</Specimen_Id>    <Order_Effect_Date>2010-07-15 00:00:00</Order_Effect_Date>    <Order_End_Date>2010-07-15 00:00:00</Order_End_Date>    <Order_Doctor_Code>602066</Order_Doctor_Code>    <Is_Force>N</Is_Force>    <Order_Name />  </Order_Record>  <Order_Record>    <Order_Code>8231020</Order_Code>    <Order_Date>2010-07-15 17:30:02</Order_Date>    <Body_Site_Code />    <Body_Side_Code />    <Dosage>0</Dosage>    <Days>1</Days>    <Tqty>1.00</Tqty>    <Tqty_Unit />    <Is_Chronic_Card>N</Is_Chronic_Card>    <Is_Cure>N</Is_Cure>    <Specimen_Id>10</Specimen_Id>    <Order_Effect_Date>2010-07-15 00:00:00</Order_Effect_Date>    <Order_End_Date>2010-07-15 00:00:00</Order_End_Date>    <Order_Doctor_Code>602066</Order_Doctor_Code>    <Is_Force>N</Is_Force>    <Order_Name />  </Order_Record>  <Order_Record>    <Order_Code>8231044</Order_Code>    <Order_Date>2010-07-15 17:30:02</Order_Date>    <Body_Site_Code />    <Body_Side_Code />    <Dosage>0</Dosage>    <Days>1</Days>    <Tqty>1.00</Tqty>    <Tqty_Unit />    <Is_Chronic_Card>N</Is_Chronic_Card>    <Is_Cure>N</Is_Cure>    <Specimen_Id>10</Specimen_Id>    <Order_Effect_Date>2010-07-15 00:00:00</Order_Effect_Date>    <Order_End_Date>2010-07-15 00:00:00</Order_End_Date>    <Order_Doctor_Code>602066</Order_Doctor_Code>    <Is_Force>N</Is_Force>    <Order_Name />  </Order_Record><Order_Record>    <Order_Code>8231043</Order_Code>    <Order_Date>2010-07-15 17:30:02</Order_Date>    <Body_Site_Code />    <Body_Side_Code />    <Dosage>0</Dosage>    <Days>1</Days>    <Tqty>1.00</Tqty>    <Tqty_Unit />    <Is_Chronic_Card>N</Is_Chronic_Card>    <Is_Cure>N</Is_Cure>    <Specimen_Id>10</Specimen_Id>    <Order_Effect_Date>2010-07-15 00:00:00</Order_Effect_Date>    <Order_End_Date>2010-07-15 00:00:00</Order_End_Date>    <Order_Doctor_Code>602066</Order_Doctor_Code>    <Is_Force>N</Is_Force>    <Order_Name />  </Order_Record>  <Order_Record>    <Order_Code>8231036</Order_Code>    <Order_Date>2010-07-15 17:30:02</Order_Date>    <Body_Site_Code />    <Body_Side_Code />    <Dosage>0</Dosage>    <Days>1</Days>    <Tqty>1.00</Tqty>    <Tqty_Unit />    <Is_Chronic_Card>N</Is_Chronic_Card>    <Is_Cure>N</Is_Cure>    <Specimen_Id>10</Specimen_Id>    <Order_Effect_Date>2010-07-15 00:00:00</Order_Effect_Date>    <Order_End_Date>2010-07-15 00:00:00</Order_End_Date>    <Order_Doctor_Code>602066</Order_Doctor_Code>    <Is_Force>N</Is_Force>    <Order_Name />  </Order_Record>  <Order_Record>    <Order_Code>8231026</Order_Code>    <Order_Date>2010-07-15 17:30:02</Order_Date>    <Body_Site_Code />    <Body_Side_Code />    <Dosage>0</Dosage>    <Days>1</Days>    <Tqty>1.00</Tqty>    <Tqty_Unit />    <Is_Chronic_Card>N</Is_Chronic_Card>    <Is_Cure>N</Is_Cure>    <Specimen_Id>10</Specimen_Id>    <Order_Effect_Date>2010-07-15 00:00:00</Order_Effect_Date>    <Order_End_Date>2010-07-15 00:00:00</Order_End_Date>    <Order_Doctor_Code>602066</Order_Doctor_Code>    <Is_Force>N</Is_Force>    <Order_Name />  </Order_Record><Order_Record>    <Order_Code>8231027</Order_Code>    <Order_Date>2010-07-15 17:30:02</Order_Date>    <Body_Site_Code />    <Body_Side_Code />    <Dosage>0</Dosage>    <Days>1</Days>    <Tqty>1.00</Tqty>    <Tqty_Unit />    <Is_Chronic_Card>N</Is_Chronic_Card>    <Is_Cure>N</Is_Cure>    <Specimen_Id>10</Specimen_Id>    <Order_Effect_Date>2010-07-15 00:00:00</Order_Effect_Date>    <Order_End_Date>2010-07-15 00:00:00</Order_End_Date>    <Order_Doctor_Code>602066</Order_Doctor_Code>    <Is_Force>N</Is_Force>    <Order_Name />  </Order_Record>  <Order_Record>    <Order_Code>8264401</Order_Code>    <Order_Date>2010-07-15 17:30:02</Order_Date>    <Body_Site_Code />    <Body_Side_Code />    <Dosage>0</Dosage>    <Days>1</Days>    <Tqty>1.00</Tqty>    <Tqty_Unit />    <Is_Chronic_Card>N</Is_Chronic_Card>    <Is_Cure>N</Is_Cure>    <Specimen_Id>04</Specimen_Id>    <Order_Effect_Date>2010-07-15 00:00:00</Order_Effect_Date>    <Order_End_Date>2010-07-15 00:00:00</Order_End_Date>    <Order_Doctor_Code>602066</Order_Doctor_Code>    <Is_Force>N</Is_Force>    <Order_Name />  </Order_Record>  <Order_Record>    <Order_Code>9320107</Order_Code>    <Order_Date>2010-07-15 17:30:02</Order_Date>    <Body_Site_Code />    <Body_Side_Code />    <Dosage>0</Dosage>    <Days>1</Days>    <Tqty>1.00</Tqty>    <Tqty_Unit />    <Is_Chronic_Card>N</Is_Chronic_Card>    <Is_Cure>N</Is_Cure>    <Specimen_Id>10</Specimen_Id>    <Order_Effect_Date>2010-07-15 00:00:00</Order_Effect_Date>    <Order_End_Date>2010-07-15 00:00:00</Order_End_Date>    <Order_Doctor_Code>602066</Order_Doctor_Code>    <Is_Force>N</Is_Force>    <Order_Name />  </Order_Record><Patient>    <Age_Year>84</Age_Year>    <Age_Month>11</Age_Month>    <Age_Day>12</Age_Day>    <Birth_Date>19260803000000</Birth_Date>    <Sex_Id>2</Sex_Id>    <Blood_Type_Id>O+</Blood_Type_Id>    <Disability>N</Disability>  </Patient></OperationDS>"

        '===================================================
        ' TestCase01
        '===================================================

        'TriggerItemSetXML = "<TriggerItemSet>  <Trigger_Item>    <ItemCode>A00004</ItemCode>    <ItemParam />    <ValueData />    <IsCodeExchanged>Y</IsCodeExchanged>  </Trigger_Item>  <Trigger_Item>    <ItemCode>D00012</ItemCode>    <ItemParam />    <ValueData>017869</ValueData>    <IsCodeExchanged>Y</IsCodeExchanged>  </Trigger_Item>  <Trigger_Item>    <ItemCode>D00013</ItemCode>    <ItemParam />    <ValueData>21</ValueData>    <IsCodeExchanged>Y</IsCodeExchanged>  </Trigger_Item>  <Trigger_Item>    <ItemCode>D00005</ItemCode>    <ItemParam />    <ValueData />    <IsCodeExchanged>Y</IsCodeExchanged>  </Trigger_Item></TriggerItemSet>"
        'OperationDSXML = "<OperationDS>  <Medical_Record>    <Source_Type>O</Source_Type>    <Medical_Sn>O20100715000082</Medical_Sn>    <Chart_No>13284799</Chart_No>    <Order_Date>2010-07-15 00:00:00</Order_Date>    <Visit_End_Date>2010-07-15 00:00:00</Visit_End_Date>    <Dept_Code>21</Dept_Code>    <Medical_Type_Id />    <Card_Sn />    <Doctor_Code>017869</Doctor_Code>    <Main_Identity_Id>2</Main_Identity_Id>    <Sub_Identity_Code>30</Sub_Identity_Code>    <Case_Type_Id />    <Part_Code />  </Medical_Record>  <Diagnosis>    <Icd_Code>1460</Icd_Code>    <Icd_Sort_Value>1</Icd_Sort_Value>    <Diagnosis_Type_Id>1</Diagnosis_Type_Id>  </Diagnosis>  <Diagnosis>    <Icd_Code>4019</Icd_Code>    <Icd_Sort_Value>2</Icd_Sort_Value>    <Diagnosis_Type_Id>1</Diagnosis_Type_Id>  </Diagnosis>  <Order_Record>    <Order_Code>8211009</Order_Code>    <Order_Date>2010-07-15 16:55:00</Order_Date>    <Body_Site_Code />    <Body_Side_Code />    <Dosage>0</Dosage>    <Dosage_Unit />    <Frequency_Code />    <Days>1</Days>    <Tqty>1</Tqty>    <Tqty_Unit />    <Is_Chronic_Card>N</Is_Chronic_Card>    <Is_Cure>N</Is_Cure>    <Specimen_Id>10</Specimen_Id>    <Order_Effect_Date>2010-07-15 16:55:00</Order_Effect_Date>    <Order_End_Date>2010-07-16 16:55:00</Order_End_Date>    <Cure_Type_Id />    <Order_Doctor_Code>017869</Order_Doctor_Code>    <Is_Force>N</Is_Force>    <Class_Code />    <Order_Name />  </Order_Record>  <Order_Record>    <Order_Code>8211018</Order_Code>    <Order_Date>2010-07-15 16:55:00</Order_Date>    <Body_Site_Code />    <Body_Side_Code />    <Dosage>0</Dosage>    <Dosage_Unit />    <Frequency_Code />    <Days>1</Days>    <Tqty>1</Tqty>    <Tqty_Unit />    <Is_Chronic_Card>N</Is_Chronic_Card>    <Is_Cure>N</Is_Cure>    <Specimen_Id>10</Specimen_Id>    <Order_Effect_Date>2010-07-15 16:55:00</Order_Effect_Date>    <Order_End_Date>2010-07-16 16:55:00</Order_End_Date>    <Cure_Type_Id />    <Order_Doctor_Code>017869</Order_Doctor_Code>    <Is_Force>N</Is_Force>    <Class_Code />    <Order_Name />  </Order_Record><Order_Record>    <Order_Code>8211019</Order_Code>    <Order_Date>2010-07-15 16:55:00</Order_Date>    <Body_Site_Code />    <Body_Side_Code />    <Dosage>0</Dosage>    <Dosage_Unit />    <Frequency_Code />    <Days>1</Days>    <Tqty>1</Tqty>    <Tqty_Unit />    <Is_Chronic_Card>N</Is_Chronic_Card>    <Is_Cure>N</Is_Cure>    <Specimen_Id>10</Specimen_Id>    <Order_Effect_Date>2010-07-15 16:55:00</Order_Effect_Date>    <Order_End_Date>2010-07-16 16:55:00</Order_End_Date>    <Cure_Type_Id />    <Order_Doctor_Code>017869</Order_Doctor_Code>    <Is_Force>N</Is_Force>    <Class_Code />    <Order_Name />  </Order_Record>  <Order_Record>    <Order_Code>8211022</Order_Code>    <Order_Date>2010-07-15 16:55:00</Order_Date>    <Body_Site_Code />    <Body_Side_Code />    <Dosage>0</Dosage>    <Dosage_Unit />    <Frequency_Code />    <Days>1</Days>    <Tqty>1</Tqty>    <Tqty_Unit />    <Is_Chronic_Card>N</Is_Chronic_Card>    <Is_Cure>N</Is_Cure>    <Specimen_Id>10</Specimen_Id>    <Order_Effect_Date>2010-07-15 16:55:00</Order_Effect_Date>    <Order_End_Date>2010-07-16 16:55:00</Order_End_Date>    <Cure_Type_Id />    <Order_Doctor_Code>017869</Order_Doctor_Code>    <Is_Force>N</Is_Force>    <Class_Code />    <Order_Name />  </Order_Record><Order_Record>    <Order_Code>8211027</Order_Code>    <Order_Date>2010-07-15 16:55:00</Order_Date>    <Body_Site_Code />    <Body_Side_Code />    <Dosage>0</Dosage>    <Dosage_Unit />    <Frequency_Code />    <Days>1</Days>    <Tqty>1</Tqty>    <Tqty_Unit />    <Is_Chronic_Card>N</Is_Chronic_Card>    <Is_Cure>N</Is_Cure>    <Specimen_Id>10</Specimen_Id>    <Order_Effect_Date>2010-07-15 16:55:00</Order_Effect_Date>    <Order_End_Date>2010-07-16 16:55:00</Order_End_Date>    <Cure_Type_Id />    <Order_Doctor_Code>017869</Order_Doctor_Code>    <Is_Force>N</Is_Force>    <Class_Code />    <Order_Name />  </Order_Record>  <Patient>    <Age_Year>45</Age_Year>    <Age_Month>1</Age_Month>    <Age_Day>6</Age_Day>    <Birth_Date>19650609000000</Birth_Date>    <Sex_Id>1</Sex_Id>    <Blood_Type_Id>A+</Blood_Type_Id>    <Disability>N</Disability>  </Patient></OperationDS>"

        '===================================================

        TriggerItemSet = parseXML(TriggerItemSetXML)
        OperationDS = parseXML(OperationDSXML)

        Result = pub.RuleTransfer("C", "O", TriggerItemSet, OperationDS)

        DataGridView1.DataSource = pub.messageDataSet.Tables("MasterMessage")
        DataGridView2.DataSource = pub.messageDataSet.Tables("RuleInfo")
        DataGridView3.DataSource = pub.messageDataSet.Tables("InitialMessage")
        DataGridView4.DataSource = pub.messageDataSet.Tables("TrueMessage")
        DataGridView5.DataSource = pub.messageDataSet.Tables("FalseMessage")
        DataGridView6.DataSource = pub.messageDataSet.Tables("FalseCondition")

        MsgBox(Result)
    End Sub

    Private Function parseXML(ByVal xmlStr As String) As System.Data.DataSet
        Try
            Dim ds As New System.Data.DataSet
            ds.ReadXml(System.Xml.XmlReader.Create(New StringReader(xmlStr)))
            Return ds
        Catch ex As Exception
            Throw ex
        End Try
    End Function

    Private Sub Button2_Click(sender As Object, e As EventArgs) Handles Button2.Click
        Dim pvtForm As New PUBLabIndication
        Dim pvtXmlData As String = ""
        'pvtXmlData = "<NewDataSet>" & vbCrLf & _
        '            "     <特殊屬性表單>" & vbCrLf & _
        '            "         <特殊屬性表單代碼>PUBLabIndication01</特殊屬性表單代碼>" & vbCrLf & _
        '            "         <特殊屬性表單名稱>細菌檢驗申請單-尿液</特殊屬性表單名稱>" & vbCrLf & _
        '            "     </特殊屬性表單>" & vbCrLf & _
        '            "     <使用抗生素>" & vbCrLf & _
        '            "         <是>N</是>" & vbCrLf & _
        '            "         <否>Y</否>" & vbCrLf & _
        '            "     </使用抗生素>" & vbCrLf & _
        '            "     <檢體來源>" & vbCrLf & _
        '            "         <Voided_x0020_midstream_x0020_urine>N</Voided_x0020_midstream_x0020_urine>" & vbCrLf & _
        '            "         <catheter>Y</catheter>" & vbCrLf & _
        '            "         <puncture>N</puncture>" & vbCrLf & _
        '            "         <PCN>N</PCN>" & vbCrLf & _
        '            "     </檢體來源>" & vbCrLf & _
        '            " </NewDataSet>"


        'pvtXmlData = "<NewDataSet>" & vbCrLf & _
        '             "   <特殊屬性表單>" & vbCrLf & _
        '             "       <特殊屬性表單代碼>PUBLabIndication02</特殊屬性表單代碼>" & vbCrLf & _
        '             "       <特殊屬性表單名稱>細菌檢驗申請單-痰液</特殊屬性表單名稱>" & vbCrLf & _
        '             "   </特殊屬性表單>" & vbCrLf & _
        '             "   <檢體來源>" & vbCrLf & _
        '             "       <p_x0027_t_x0020_cough>N</p_x0027_t_x0020_cough>" & vbCrLf & _
        '             "       <oral_x0020_suction>Y</oral_x0020_suction>" & vbCrLf & _
        '             "       <Endo._x0020_suction>N</Endo._x0020_suction>" & vbCrLf & _
        '             "       <Tracheal_x0020_suction>N</Tracheal_x0020_suction>" & vbCrLf & _
        '             "       <bronchial_x0020_suction>N</bronchial_x0020_suction>" & vbCrLf & _
        '             "   </檢體來源>" & vbCrLf & _
        '            "</NewDataSet>"

        'pvtXmlData = "<NewDataSet> " & vbCrLf & _
        '             " <特殊屬性表單> " & vbCrLf & _
        '             "   <特殊屬性表單代碼>PUBLabIndication07</特殊屬性表單代碼> " & vbCrLf & _
        '             "   <特殊屬性表單名稱>病理細胞申請單</特殊屬性表單名稱> " & vbCrLf & _
        '             " </特殊屬性表單> " & vbCrLf & _
        '             " <臨床診斷敘述> " & vbCrLf & _
        '             "   <臨床診斷敘述內容>aaa</臨床診斷敘述內容> " & vbCrLf & _
        '             " </臨床診斷敘述> " & vbCrLf & _
        '             " <Indication> " & vbCrLf & _
        '             "   <Indication_Type>1</Indication_Type> " & vbCrLf & _
        '             "   <Diagnosis_Memo>aaa</Diagnosis_Memo> " & vbCrLf & _
        '             " </Indication> " & vbCrLf & _
        '             "</NewDataSet> "

        'pvtXmlData = "<NewDataSet> " & vbCrLf & _
        '             "   <特殊屬性表單> " & vbCrLf & _
        '             "   <特殊屬性表單代碼>PUBLabIndication08</特殊屬性表單代碼> " & vbCrLf & _
        '             "   <特殊屬性表單名稱>病理切片申請單</特殊屬性表單名稱> " & vbCrLf & _
        '             "   </特殊屬性表單> " & vbCrLf & _
        '             "   <組織由來> " & vbCrLf & _
        '             "   <組織由來內容>aaa</組織由來內容> " & vbCrLf & _
        '             "   </組織由來> " & vbCrLf & _
        '             "   <臨床診斷敘述> " & vbCrLf & _
        '             "   <臨床診斷敘述內容>bbb</臨床診斷敘述內容> " & vbCrLf & _
        '             "   </臨床診斷敘述> " & vbCrLf & _
        '             "   <病歷摘要> " & vbCrLf & _
        '             "   <病歷摘要內容>ccc</病歷摘要內容> " & vbCrLf & _
        '             "   </病歷摘要> " & vbCrLf & _
        '             "   <手術方式> " & vbCrLf & _
        '             "   <手術方式內容>dd</手術方式內容> " & vbCrLf & _
        '             "   </手術方式> " & vbCrLf & _
        '             "  <Indication> " & vbCrLf & _
        '             "   <Indication_Type>1</Indication_Type> " & vbCrLf & _
        '             "   <Bilolgy_Orign>aaa</Bilolgy_Orign> " & vbCrLf & _
        '             "   <Diagnosis_Memo>bbb</Diagnosis_Memo> " & vbCrLf & _
        '             "   <Chart_Summary>ccc</Chart_Summary> " & vbCrLf & _
        '             "   <Surgical>dd</Surgical> " & vbCrLf & _
        '             "   </Indication> " & vbCrLf & _
        '             "</NewDataSet> "
        'pvtForm = New PUBLabIndication("Y", "LA", "21", "", "", pvtXmlData)
        'pvtForm = New PUBLabIndication("Y", "LA", "13", "", "", pvtXmlData)
        'pvtForm = New PUBLabIndication("Y", "LA", "99", "", "", pvtXmlData)
        'pvtForm = New PUBLabIndication("Y", "LD", "", "30022", "", pvtXmlData)
        'pvtForm = New PUBLabIndication("Y", "LA", "51", "130071", "", pvtXmlData)
        'pvtForm = New PUBLabIndication("Y", "LA", "47", "130061", "Gram Stain", pvtXmlData)
        'pvtForm = New PUBLabIndication("Y", "LC", "", "", "", pvtXmlData)
        'pvtForm = New PUBLabIndication("Y", "LP", "", "", "", pvtXmlData)
        'pvtForm = New PUBLabIndication("Y", "LA", "02", "13016", "Blood culture", pvtXmlData, 2)
        pvtForm = New PUBLabIndication("Y", "LP", "", "", "", pvtXmlData, 2, "E100009375", "2017-02-27")
        'pvtForm = New PUBLabIndication("Y", "LP", "", "", "", pvtXmlData, 2, "", "")
        MessageBox.Show("特殊屬性類型：" & pvtForm.gblArrayData(0) & vbCrLf & "特殊屬性內容：" & pvtForm.gblArrayData(1))

        
    End Sub

    
End Class